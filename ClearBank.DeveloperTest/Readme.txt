More error/exception handling and defensive coding would be required in production code, but for the sake of brevity that has been omitted from the submitted solution.